# Flow Log Tagging Program
## Overview
This project contains a Python script designed to parse a file containing flow log data and map each row to a tag based on a lookup table. The script produces an output file that counts the matches for each tag and each port/protocol combination.

## Key Features:
- **Flow Log Parsing:** The program reads flow logs from a text file.
* **Tag Lookup:** It uses a lookup table (CSV format) to map dstport and protocol combinations to predefined tags.
+ **Output Generation:** The program outputs the count of matches for each tag and each port/protocol combination.
## Assumptions
1. **Flow Log Format:** The program is designed to support the default log format version 2 only.
2. **Protocol Matching:** The protocol numbers in the flow logs are matched against protocol names (tcp, udp) in the lookup table.
3. **Case Insensitivity:** The matching process is case insensitive.
4. **Output Categories:** The flow log entry is categorized under "Untagged" if no tag matches.
### Files
- **main.py:** The main Python script to run the program.
* **flow_logs.txt:** A sample flow log file.
+ **lookup_table.csv:** A CSV file containing dstport, protocol, and tag mappings.
- **output_results.csv:** The output file generated by the script.
## How to Run the Program
### Prerequisites
* Python 3.x installed on your machine.
## Running the Program
1. **Place the files:**
   
* Ensure that main.py, flow_logs.txt, and lookup_table.csv are in the same directory.
2. **Run the script**:

* Open a terminal and navigate to the directory containing the files.
- Execute the script by running:
```
python main.py
```
* This will generate an output_results.csv file in the same directory.
## Output
The output file **output_results.csv** contains two sections:

1. **Tag Counts:**
* Lists the count of flow logs for each tag.
2. **Port/Protocol Combination Counts:**
* Lists the count of occurrences for each unique port/protocol combination found in the flow logs.
## Testing
* **Sample Data:** The provided flow_logs.txt and lookup_table.csv are sample files used to demonstrate the functionality.
* **Tested Scenarios:**
  - Matching flow logs with the lookup table for various dstport and protocol combinations.
  - Handling of flow logs that do not match any tag in the lookup table.
  - Case insensitivity during protocol matching.
## Analysis and Considerations
* **Performance:** The program reads the entire flow log file line by line and matches it against the lookup table. The approach should be efficient for files within the 10 MB size limit, as per the problem statement.
- **Scalability**: The current implementation should scale well within the given constraints. However, for much larger files or more complex lookup logic, optimizations might be necessary.
## Known Issues
* **Protocol Mapping:** The script assumes a direct mapping of protocol numbers to names (tcp, udp). If other protocols are encountered, they are classified under "unknown", which might require additional mappings.
## Conclusion
This project fulfills the requirements as outlined, efficiently processing flow logs and generating the necessary output. The design choices ensure that the program remains simple, with minimal dependencies, making it easy to run and review on any machine with Python installed.
